---
import DarkModeSwitch from "./DarkModeSwitch"
import "./header.scss"

const pages = [
  { name: "blog", path: "/blog" },
  { name: "contact", path: "/contact" },
  { name: "projects", path: "/projects" },
  { name: "recipes", path: "/recipes" },
]

const currentPath = Astro.url.pathname
---

<header>
  <div class="brand">
    <a href="/" aria-label="Brand Logo" class="brand__logo">
      <img src="/logo.svg" alt="Logo" />
    </a>
    <span class="brand__name">Karlo Delalic</span>
  </div>
  <div class="navbar-burger" id="navbar-burger">
    <span></span>
    <span></span>
    <span></span>
  </div>
  <nav class="navbar" id="navbar">
    <a href="/" class:list={["navbar__item", { active: currentPath === "/" }]}>
      Home
    </a>
    {
      pages.map((page) => (
        <a
          href={page.path}
          class:list={[
            "navbar__item",
            { active: currentPath.startsWith(page.path) },
          ]}
        >
          {page.name}
        </a>
      ))
    }
  </nav>
  <DarkModeSwitch client:load transition:persist />
</header>

<script>
  const burger = document.getElementById("navbar-burger")
  const navbar = document.getElementById("navbar")

  if (burger && navbar) {
    const toggleNavbar = () => {
      burger.classList.toggle("open")
      navbar.classList.toggle("open")
    }

    const closeNavbar = () => {
      burger.classList.remove("open")
      navbar.classList.remove("open")
    }

    burger.addEventListener("click", toggleNavbar)
    burger.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault()
        toggleNavbar()
      }
    })

    navbar.addEventListener("click", closeNavbar)
    navbar.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        closeNavbar()
      }
    })
  }
</script>
